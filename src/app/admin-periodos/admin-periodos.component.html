<div class="container my-4">
  <h3 class="mb-4 text-primary fw-bold">
    <i class="bi bi-calendar-check-fill me-2"></i> Gestión de Periodos de Inscripción
  </h3>

  <form (ngSubmit)="crearPeriodo()" #periodoForm="ngForm" novalidate>
    <div class="row g-3 align-items-center mb-3">
      <div class="col-md-5">
        <label for="nombrePeriodo" class="form-label fw-semibold">Nombre del Periodo <span class="text-danger">*</span></label>
        <input 
          id="nombrePeriodo" 
          name="nombrePeriodo" 
          type="text" 
          class="form-control" 
          [(ngModel)]="nuevoPeriodo.nombrePeriodo" 
          #nombrePeriodo="ngModel" 
          required
          [class.is-invalid]="nombrePeriodo.invalid && nombrePeriodo.touched"
          placeholder="Ej: Inscripción Junio 2025"
        />
        <div class="invalid-feedback">Este campo es obligatorio.</div>
      </div>

      <div class="col-md-3">
        <label for="fechaInicio" class="form-label fw-semibold">Fecha Inicio <span class="text-danger">*</span></label>
        <input 
          id="fechaInicio" 
          name="fechaInicio" 
          type="date" 
          class="form-control" 
          [(ngModel)]="nuevoPeriodo.fechaInicio" 
          #fechaInicio="ngModel" 
          required
          [class.is-invalid]="fechaInicio.invalid && fechaInicio.touched"
        />
        <div class="invalid-feedback">Selecciona la fecha de inicio.</div>
      </div>

      <div class="col-md-3">
        <label for="fechaFin" class="form-label fw-semibold">Fecha Fin <span class="text-danger">*</span></label>
        <input 
          id="fechaFin" 
          name="fechaFin" 
          type="date" 
          class="form-control" 
          [(ngModel)]="nuevoPeriodo.fechaFin" 
          #fechaFin="ngModel" 
          required
          [class.is-invalid]="fechaFin.invalid && fechaFin.touched"
        />
        <div class="invalid-feedback">Selecciona la fecha de fin.</div>
      </div>

      <div class="col-md-1 d-flex align-items-end">
        <button 
          type="submit" 
          class="btn btn-primary w-100" 
          [disabled]="periodoForm.form.invalid"
          title="Crear nuevo periodo"
        >
          <i class="bi bi-plus-lg"></i>
        </button>
      </div>
    </div>
  </form>

  <hr />

  <div class="table-responsive" style="max-height: 500px; overflow-y: auto; border: 1px solid #dee2e6; border-radius: .5rem;">
    <table class="table table-hover table-bordered align-middle text-nowrap mb-0">
      <thead class="table-primary position-sticky top-0">
        <tr>
          <th>Nombre del Periodo</th>
          <th>Fecha Inicio</th>
          <th>Fecha Fin</th>
          <th>Estado</th>
          <th class="text-center">Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let p of periodos">
          <td>{{ p.nombrePeriodo }}</td>
          <td>{{ p.fechaInicio | date:'mediumDate' }}</td>
          <td>{{ p.fechaFin | date:'mediumDate' }}</td>
          <td>
            <span 
              class="badge" 
              [ngClass]="p.estado ? 'bg-success' : 'bg-secondary'"
              >{{ p.estado ? 'Activo' : 'Inactivo' }}</span>
          </td>
          <td class="text-center">
            <button 
              *ngIf="!p.estado" 
              class="btn btn-sm btn-outline-primary"
              (click)="activarPeriodo(p.idPeriodo!)"
              title="Activar periodo"
            >
              <i class="bi bi-toggle-on"></i>
            </button>
            <span *ngIf="p.estado" class="text-muted fst-italic">-</span>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
