<div class="container mt-4">
  <h3 class="text-primary fw-bold mb-4 text-center">Mi Perfil</h3>

  <div class="row justify-content-center gx-4 gy-4">
    <!-- Imagen y controles -->
    <div class="col-12 col-sm-6 col-md-4 text-center">
      <div
        class="photo-container"
        style="width: 180px; height: 180px; margin: 0 auto;"
        title="Foto de perfil"
      >
        <img
          [src]="usuario?.foto || '/img/usuario-default.png'"
          alt="Foto de perfil"
          (click)="inputFile.click()"
        />
      </div>

      <input
        #inputFile
        type="file"
        (change)="onFotoSeleccionada($event)"
        class="form-control form-control-sm mt-3"
        style="max-width: 180px; margin: 0 auto;"
      />
      <button
        class="btn btn-primary btn-sm w-100 mt-2"
        (click)="actualizarFoto()"
        style="max-width: 180px; margin: 0 auto;"
      >
        Actualizar Foto
      </button>

      <div *ngIf="vistaPreviaFoto" class="mt-3 text-center">
        <p class="fw-semibold mb-2">Vista previa:</p>
        <img
          [src]="vistaPreviaFoto"
          alt="Vista previa foto"
          class="img-thumbnail"
          style="max-width: 180px;"
        />
      </div>
    </div>

    <!-- Información usuario -->
    <div class="col-12 col-sm-10 col-md-8">
      <div class="info-card">
        <div class="row mb-3">
          <div class="col-4 fw-semibold text-secondary">Nombres</div>
          <div class="col-8">{{ usuario?.nombres }}</div>
        </div>
        <div class="row mb-3">
          <div class="col-4 fw-semibold text-secondary">Apellidos</div>
          <div class="col-8">{{ usuario?.apellidos }}</div>
        </div>
        <div class="row mb-3">
          <div class="col-4 fw-semibold text-secondary">Cédula</div>
          <div class="col-8">{{ usuario?.cedula }}</div>
        </div>
        <div class="row mb-3">
          <div class="col-4 fw-semibold text-secondary">Correo</div>
          <div class="col-8 text-break">{{ usuario?.correo }}</div>
        </div>
        <div class="row mb-3">
          <div class="col-4 fw-semibold text-secondary">Rol</div>
          <div class="col-8">{{ usuario?.rol }}</div>
        </div>
        <div class="row mb-4">
          <div class="col-4 fw-semibold text-secondary">Grupo</div>
          <div class="col-8">{{ usuario?.grupo }}</div>
        </div>

        <!-- Formulario Teléfono en línea -->
        <form
          [formGroup]="telefonoForm"
          (ngSubmit)="actualizarTelefono()"
          class="d-flex flex-wrap align-items-center gap-3"
          novalidate
        >
          <label
            for="telefono"
            class="form-label fw-semibold mb-0"
            style="min-width: 80px;"
            >Teléfono</label
          >
          <input
            id="telefono"
            type="text"
            formControlName="telefono"
            class="form-control flex-grow-1"
            placeholder="Ingrese su teléfono"
            aria-describedby="telefonoHelp"
          />
          <button
            type="submit"
            class="btn btn-success px-4"
            [disabled]="telefonoForm.invalid"
          >
            Actualizar
          </button>
        </form>

        <div
          *ngIf="
            telefonoForm.get('telefono')?.touched &&
            telefonoForm.get('telefono')?.invalid
          "
          class="text-danger mt-2 small"
          role="alert"
        >
          <div *ngIf="telefonoForm.get('telefono')?.errors?.['required']">
            El teléfono es obligatorio.
          </div>
          <div *ngIf="telefonoForm.get('telefono')?.errors?.['pattern']">
            El teléfono debe tener exactamente 10 números.
          </div>
        </div>
      </div>
    </div>
  </div>
</div>